> /bw_modify目录  
# 修改带宽数据的功能
- shaper值
- 带宽上限值（暂未实现）


---

[20170622]  

**配置文件修改的 3 种情况：**  
1. 所有shaper的带宽值相同
2. 大部分shaper的带宽相同，部分带宽值单独指定
3. 在当前的基础上，只针对个别shaper做调整


**实现配置文件修改的思想:**  
将 3 种情况合并，`app.c`文件中对应的pir值全都取自一个数组`pir[4000]`; `pir[4000]`这个数组通过一个`sh_pir.csv`文件生成;  
所以，需要的工作简化为针对 3 种情况适当修改`sh_pir.csv`文件，  
对于`app.c`文件，只需加上从csv构建数值的代码即可。



**csv文件修改思想：**  
对应 `sh_pir_csv_modify.py` 模块  
`pir_csv_modify`函数的输入包含两个参数:  
    `def_bw`: 默认带宽，用于修改大部分带宽相同的情况, 类型为数值，单位 M  
    `spec_bw`: 指定特定shaper带宽，类型为字典`{'shaper id(0-4000)':对应带宽(数值，单位M)}`  
输出：  
    更新后的`sh_dir.csv`文件，内容为4000个pir值，如0x1308


**工作方式:**  
1. 所有带宽都修改，并且所有带宽相同的情况，只传`def_bw`参数  
    `pir_csv_modify(def_bw = bw)`
2. 所有带宽都修改，其中有大部分带宽相同的情况，传两个参数  
    `pir_csv_bw(def_bw = bw, spec_bw = dict)`
3. 在当前工作情况的基础上，修改个别带宽，只传`spec_bw`参数，此时不需要调整全部带宽值，只要修改指定的即可  
    `pir_csv_modify(spec_bw = dict)`
4. 不传参数时，不修改csv文件，只是检查文件是否存在，不存在会创建一个代表所有带宽都为 0M 的csv文件  


**辅助模块:**  
`bw_to_pir.py`  
输入为带宽值，如 8, 0, 0.5等，单位 M  
输出为对应的 4 位 16 进制pir值，如0x1308, 0x0000  



*注: 对于所需传入的字典参数，初步的设想是通过web上点击选取 `shaper id` ，输入想要修改的带宽值，
web上提交的结果是生成一个对应的字典，传入`modify`函数*  

---

[20170623]  

**新增一种修改pir.csv文件的方式：**  
通过传入指定带宽的csv文件修改，带宽csv文件格式为两列；  
- 第一列为`shaper id` (0-4000)(不必全指定，给出需要修改的id和对应的bw即可)
- 第二列为对应带宽值(M)



**新增辅助模块:**  
`csv_to_dict`  
用于将带宽csv文件转换为对应的dict，此时新模式就变为之前的传字典的模式


**调整一部分修改细节**  


**加入了修改的app.c文件**  


*注：新增方式可用于在web上选取提前构建的带宽文件修改*  


---
[20170817]  

**新想法**  
*为了实现在当前基础上修改，需要提供读取指定`sh_pir.csv`文件的功能*  
*这里的保存文件不需要指定，只需存到data中用于编译即可，在编译时才会指定备份的特定文件名*  


**调整pir_csv_modify函数**  
`pir_csv_modify(def_bw = None, spec_bw = None, bw_csv = None, ref_csv = sh_pir)`  
增加了一个参数：`ref_csv`  
表示指定的修改参考文件，比如可用于指定参考当前使用中的规则，即读取当前规则的pir进行修改
